#!/usr/bin/perl

use strict;
use warnings;
use IO::Socket::INET;

while (1)
{
function();
}
sub function {
my $socket;
my  $clientsocket;
my $serverdata;
my $clientdata;

$socket = new IO::Socket::INET (
    LocalHost => '127.0.0.1',
    LocalPort => '0160',
    Proto => 'tcp',
    Listen => 1,
    Reuse => 1
) or die "Oops: $! \n";
print "Waiting for the Client.\n";


$clientsocket = $socket->accept();

print   "Connected from : ", $clientsocket->peerhost();     # Display messages
print   ", Port : ", $clientsocket->peerport(), "\n";

# Write some data to the client  
#$serverdata = "PID pere $$:)\n";
#print $clientsocket "$serverdata \n";

# read the data from the client
my $Options = <$clientsocket>;
print $Options;

#system("tshark $clientdata > /home/czhn4415/Desktop/FinalyMyResult");



#system("$Options > /opt/lampp/htdocs/Stage/resultats/houssem");
#print $clientsocket "done";



#my @res = `$Options`;
#print @res;
#print $clientsocket @res;
system("$Options > /opt/lampp/htdocs/Stage2/resultats/tmp");
print $clientsocket "done";
shutdown($clientsocket, 1);


$socket->close(); 

}


